<svg class="navbar-bckgrnd" viewBox="0 0 1440 182" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M0 0H1440V108L749.5 160L0 182V0Z" fill="url(#paint0_linear)"/>
<defs>
<linearGradient id="paint0_linear" x1="9.00006" y1="108" x2="79.1478" y2="-259.651" gradientUnits="userSpaceOnUse">
<stop stop-color="#3C82FF"/>
<stop offset="1" stop-color="#3AEBBA"/>
</linearGradient>
</defs>
</svg>

<div class="container">
  <div class="card-space-top">
    <div class="inbox">
      <% count = 0 %>
      <ul>
      <% @user_alerts.each do |alert| %>
      <li>
        <div class="col-xs-12 col-md-6">
          <div class="card-index">
            <div class="card-body">
              <div class="back-white">
                <%= image_tag "back-white.svg", alt: "white-back", class:"back-white-picture" %>


                <div class="alert-link">
                  <%= link_to 'More details', alert_path(alert), class:"btn btn-success no-decoration see-detail alert-link-format" %>
                  <%= link_to 'Edit', alert_path(alert), class:"btn btn-success no-decoration see-detail alert-link-format" %>
                  <%= link_to "Delete", alert_path(alert), class:"btn btn-success no-decoration see-detail alert-link-format",
                  method: :delete %>
                </div>



                <div class="alert-number">
                  <% count += 1 %>
                  <p><%= count %></p>
                </div>



                <div class="alert-avatar">
                  <p><%= alert.product.name %></p>
                  <br>
                  <%= image_tag alert.product.photo, :crop=>"thumb" %>
                </div>



                  <div class="card-header">
                    <div class="alert-price">
                      <p>Target price </p>
                      <p class="price-font">€<%= alert.target_price.to_i %> </p>
                      <br>
                      <p>Today best offer:</p>

                      <% if alert.offer_today %>
                        <p>Retailer: <%= alert.lowest_price_retailer.name %>:</p>
                        <p class="price-font"> €<%= alert.lowest_price.price %></p>
                      <% else %>
                        <% if Date.current == alert.created_at.to_date %>
                          <p class="price-font">€<%= alert.product.description %></p>
                        <% else %>
                          <p class="price-font">No offer today</p>
                        <% end %>
                      <% end %>
                      <% target_price = alert.target_price %>
                      <% current_price = alert.product.description %>
                      <% difference = (current_price.to_i - target_price.to_i).to_i %>
                      <p>Difference </p>
                      <p class="price-font">€<%= difference %></p>
                    </div>
                 </div>




                 <div class="alert-communication">
                  <ul>
                    <% if alert.by_email %>
                    <li><i class="fas fa-at"></i></li>
                    <% end %>
                    <% if alert.by_text_message %>
                    <li><i class="fas fa-sms"></i></li>
                    <% end %>
                  </ul>
                </div>



              </div>
            </div>
          </div>



          <div class="graph-prix">
            <% if alert.lowest_prices.blank? %>
              <h3 class="text-center">Not enough data..</h3>
            <% else %>
              <canvas class="alert-chart" width="300" height="150" data-lowest-prices="<%= alert.lowest_prices.order(:created_at).limit(7).map { |lowest_price| lowest_price.price.price }.to_json %>"></canvas>
            <% end %>
          </div>



          </li>
        <% end %>
      </ul>
    </div>
    </div>
  </div>
</div>



